(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Goods/details"],{"272c":function(t,e,o){"use strict";var n=o("5713"),i=o.n(n);i.a},"3a04":function(t,e,o){"use strict";(function(t){o("8ef2");n(o("66fd"));var e=n(o("c401"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},5713:function(t,e,o){},"68a1":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={uImage:function(){return o.e("uview-ui/components/u-image/u-image").then(o.bind(null,"725b"))},uIcon:function(){return o.e("uview-ui/components/u-icon/u-icon").then(o.bind(null,"6679"))},uCountDown:function(){return o.e("uview-ui/components/u-count-down/u-count-down").then(o.bind(null,"7ed5"))},uParse:function(){return Promise.all([o.e("common/vendor"),o.e("uview-ui/components/u-parse/u-parse")]).then(o.bind(null,"5172"))},uPopup:function(){return o.e("uview-ui/components/u-popup/u-popup").then(o.bind(null,"ad6e"))},uLoading:function(){return o.e("uview-ui/components/u-loading/u-loading").then(o.bind(null,"2c5b"))},uNumberBox:function(){return o.e("uview-ui/components/u-number-box/u-number-box").then(o.bind(null,"1b2c"))},uSkeleton:function(){return o.e("uview-ui/components/u-skeleton/u-skeleton").then(o.bind(null,"1822"))}},i=function(){var t=this,e=this,o=e.$createElement,n=(e._self._c,null);e._isMounted||(e.e0=function(t){e.feeSize=e.goodsData.member_face.length},e.e1=function(t){e.feeSize=30},e.e2=function(t){e.isShow=!1},e.e3=function(){t.$refs.popupBy.close()},e.e4=function(t){e.path=t}),e.$mp.data=Object.assign({},{$root:{l0:n}})},s=[]},"9cd1":function(t,e,o){"use strict";o.r(e);var n=o("baf7"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},baf7:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("a34a")),i=o("4c0b");function s(t){return t&&t.__esModule?t:{default:t}}function r(t,e,o,n,i,s,r){try{var a=t[s](r),u=a.value}catch(c){return void o(c)}a.done?e(u):Promise.resolve(u).then(n,i)}function a(t){return function(){var e=this,o=arguments;return new Promise((function(n,i){var s=t.apply(e,o);function a(t){r(s,n,i,a,u,"next",t)}function u(t){r(s,n,i,a,u,"throw",t)}a(void 0)}))}}var u=function(){Promise.all([o.e("common/vendor"),o.e("component/lime-painter/index")]).then(function(){return resolve(o("62ef"))}.bind(null,o)).catch(o.oe)},c={components:{LimePainter:u},data:function(){return{swiperCurrent:1,goods_id:"",isColl:!1,isLogin:!1,isShow:!1,isFormat:!1,isNotFormat:!1,number:1,m_id:t.getStorageSync("m_id")||"",goodsData:{},loadSkeleton:!0,selectArr:[],format:{},path:"",isPosterPopup:!1,isPoster:!1,base:{},feeSize:30}},onLoad:function(e){t.showLoading({title:"加载中..."}),e.parent_code&&t.setStorageSync("parent_code",e.parent_code),this.goods_id=e.id,this.getGoodsDetail(e.id,this.m_id,!0)},onShow:function(){this.m_id=t.getStorageSync("m_id")||""},onShareAppMessage:function(){var e=t.getStorageSync("code");return{title:this.goodsData.share.goods_name,path:"/pages/Goods/details?id="+this.goods_id+"&parent_code="+e,success:function(t){console.log("分享成功"+t)},fail:function(t){console.log(t+"失败")}}},watch:{m_id:function(t){this.moreGoodsDetail(this.goods_id,t)},path:function(e){var o=this;this.isPosterPopup=!0,t.hideLoading(),this.$nextTick((function(){o.savePath()}))}},computed:{isAction:function(){return 1==this.goodsData.time_status}},methods:{swiperChange:function(t){this.swiperCurrent=t.detail.current+1;for(var e=this.goodsData.pictures.length,o=0;o<e;o++)this["videoContext"+o].pause()},attention:function(){var e=t.getStorageSync("m_id");if(""===e||void 0===e)return this.isLogin=!0;var o=this;this.isColl||0!=this.goodsData.time_status?o.network(e,o.goods_id):wx.requestSubscribeMessage({tmplIds:["eAMJeJRgbBa9zSeZ_CwvuTsGKu2D0oq1uhK_7mNDdeQ"],success:function(t){o.network(e,o.goods_id)},fail:function(e){return console.log(e),t.showToast({title:"关注失败",icon:"none"})}})},network:function(e,o){var n=this;(0,i.attentionGoods)({m_id:e,goods_id:o,is_coll:this.isColl?1:0}).then((function(e){n.isColl=!n.isColl,wx.vibrateShort(),t.$emit("updata"),t.showToast({title:"操作成功"})})).catch((function(e){t.showToast({title:e,icon:"none"})}))},routerRule:function(e){t.navigateTo({url:"/pages/Home/rule?type="+e})},getGoodsDetail:function(e,o,s){var r=this;return a(n.default.mark((function s(){var a,u,c,d;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,i.goodsDetail)({goods_id:e,m_id:o});case 3:for(a=n.sent,u={price:a.price,market_price:a.market_price,goods_attr:[],goods_moeny:a.goods_moeny,pictures:a.cover,stock_fen:a.stock_fen,chu_stock_fen:0},r.goodsData=a,r.isColl=1==a.is_coll,r.format=u,r.producePoster(a.share),c=a.pictures.length,d=0;d<c;d++)r["videoContext"+d]=t.createVideoContext("video"+d);r.loadSkeleton=!1,t.hideLoading(),n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](0),t.showToast({title:n.t0,icon:"none",success:function(){setTimeout((function(){t.navigateBack({delta:1})}),1500)}});case 18:case"end":return n.stop()}}),s,null,[[0,15]])})))()},moreGoodsDetail:function(e,o,s){var r=this;return a(n.default.mark((function a(){var u;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,i.goodsDetail)({goods_id:e,m_id:o});case 3:u=n.sent,r.goodsData=u,r.isColl=1==u.is_coll,s&&(r.loadSkeleton=!1),t.hideLoading(),r.$nextTick((function(){r.$refs.uCountDown.start()})),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),t.showToast({title:n.t0,icon:"none"});case 14:case"end":return n.stop()}}),a,null,[[0,11]])})))()},videoPlay:function(t){this["videoContext"+t].play(),this.goodsData.pictures[t].isShow=!0},videoPause:function(t){this.goodsData.pictures[t].isShow=!1},videoAction:function(t){this.goodsData.pictures[t].isShow=!0},snapEnd:function(){this.moreGoodsDetail(this.goods_id,this.m_id)},publishDown:function(){var e=this;t.showLoading({title:"轮次更新中...",mask:!0}),setTimeout((function(){e.moreGoodsDetail(e.goods_id,e.m_id,!0)}),300)},snapUp:function(){var e=t.getStorageSync("m_id");return e||""!==e?1==this.goodsData.hasSku?this.isFormat=!0:this.isNotFormat=!0:this.isLogin=!0},shareEvent:function(){var e=t.getStorageSync("m_id");if(!e&&""===e)return this.isLogin=!0;this.isShow=!0},directPay:function(){var e=this;t.showLoading({title:"下单中...",mask:!0}),(0,i.goodsConOrder)({m_id:this.m_id,goods_id:this.goods_id,quantity:this.number,goods_attr_ids:"",goods_attr_desc:""}).then((function(o){getApp().globalData.order=o,t.navigateTo({url:"/pages/Order/submitOrder?m_id="+e.m_id,success:function(){t.hideLoading()}})})).catch((function(e){t.showToast({title:e,icon:"none"})}))},jumpLogin:function(){this.isLogin=!1,t.navigateTo({url:"/pages/My/login"})},changeFormat:function(t,e,o){var n=this.goodsData.goods_attr[e].attr_values,i=this.goodsData.goods_attr[e].attr_values.length;if(this.selectArr[e]!=t.goods_attr_id){this.selectArr[e]=t.goods_attr_id;for(var s=0;s<i;s++)n[s].is_show=!1;n[o].is_show=!0,this.getGoodsInquire()}else this.selectArr[e]="",n[o].is_show=!1,this.getGoodsInquire()},getGoodsInquire:function(){var e=this;return a(n.default.mark((function o(){var s,r;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,s=e.selectArr.join("|"),1===s.length&&"|"===s&&(s=""),o.next=5,(0,i.goodsInquire)({goods_id:e.goods_id,attr_id:s});case 5:r=o.sent,e.format=r,o.next=12;break;case 9:o.prev=9,o.t0=o["catch"](0),t.showToast({title:o.t0,icon:"none"});case 12:case"end":return o.stop()}}),o,null,[[0,9]])})))()},confirmOrder:function(){var e=this;if(0==this.number)return t.showToast({title:"购买数量低于范围~",icon:"none"});if(this.number>this.goodsData.vip_limit-0)return t.showToast({title:"该商品限购".concat(this.goodsData.vip_limit,"件~"),icon:"none"});var o=this.selectArr.filter((function(t){return t&&t.trim()}));if(0===o.length||o.length!==this.goodsData.goods_attr.length)return t.showToast({title:"请选择商品规格~",icon:"none"});t.showLoading({title:"正在下单...",mask:!0});var n=this.selectArr.join("|");1===n.length&&"|"===n&&(n="");for(var s="",r=this.format.goods_attr.length,a=0;a<r;a++)s+=this.format.goods_attr[a].attr_name+"： "+this.format.goods_attr[a].attr_value+" ";(0,i.goodsConOrder)({m_id:this.m_id,goods_id:this.goods_id,quantity:this.number,goods_attr_ids:n,goods_attr_desc:s}).then((function(o){getApp().globalData.order=o,t.navigateTo({url:"/pages/Order/submitOrder?m_id="+e.m_id,success:function(){e.isFormat=!1,t.hideLoading()}})})).catch((function(e){t.showToast({title:e,icon:"none"})}))},producePoster:function(t){var e={width:"590rpx",height:"900rpx",backgroundColor:"#fff",views:[{type:"image",src:t.cover,mode:"aspectFit",css:{left:"0rpx",top:"0rpx",width:"590rpx",height:"590rpx"}},{type:"image",src:t.face,css:{left:"30rpx",top:"40rpx",width:"52rpx",height:"52rpx",radius:"50%"}},{type:"text",text:t.nickname,css:{left:"90rpx",top:"45rpx",color:"#333",fontSize:"26rpx"}},{type:"image",src:o("44ae"),css:{left:"0rpx",top:"590rpx",width:"590rpx",height:"78rpx"}},{type:"text",text:"￥",css:{left:"30rpx",top:"625rpx",fontSize:"28rpx",fontFamily:"Adobe Heiti Std",color:"#fff"}},{type:"text",text:t.price,css:{left:"58rpx",top:"610rpx",fontSize:"42rpx",color:"#fff",fontFamily:"Adobe Heiti Std"}},{type:"text",text:"￥"+t.market_price,css:{left:"230rpx",maxLines:1,top:"627rpx",fontSize:"24rpx",color:"#f2f2f2",textDecoration:"line-through"}},{type:"text",text:"预估收益",css:{fontSize:"20rpx",color:"#F23129",top:"600rpx",left:"460rpx"}},{type:"view",css:{width:"120rpx",height:"34rpx",backgroundColor:"#F23129",radius:"10rpx",top:"635rpx",left:"440rpx"}},{type:"text",text:t.goods_moeny+"元",css:{fontSize:"20rpx",color:"#fff",top:"638rpx",left:"470rpx"}},{type:"text",text:t.goods_name,css:{width:"300rpx",maxLines:2,fontSize:"30rpx",lineHeight:"48rpx",left:"30rpx",top:"690rpx"}},{type:"image",src:t.share_image,mode:"aspectFit",css:{width:"150rpx",height:"150rpx",top:"716rpx",left:"410rpx"}}]};this.base=e},failPath:function(e){console.log(e),t.hideLoading(),t.showToast({title:"海报生成失败，请重试",icon:"none"})},posterEvent:function(){if(this.isShow=!1,""!==this.path)return this.isPosterPopup=!0,void this.savePath();t.showLoading({title:"海报生成中..."}),this.isPoster=!0},savePath:function(){t.saveImageToPhotosAlbum({filePath:this.path,success:function(e){t.showToast({title:"已保存到相册",icon:"success",duration:2e3})}})}}};e.default=c}).call(this,o("543d")["default"])},c401:function(t,e,o){"use strict";o.r(e);var n=o("68a1"),i=o("9cd1");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("272c");var r,a=o("f0c5"),u=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=u.exports}},[["3a04","common/runtime","common/vendor"]]]);